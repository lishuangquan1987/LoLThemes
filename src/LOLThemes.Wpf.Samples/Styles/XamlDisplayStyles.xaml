<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:smtx="clr-namespace:ShowMeTheXAML;assembly=ShowMeTheXAML"
                    xmlns:smtxAe="clr-namespace:ShowMeTheXAML.AvalonEdit;assembly=ShowMeTheXAML.AvalonEdit"
                    xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit">
    
    <!-- 合并基础资源 -->
    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/LOLThemes.Wpf;component/Themes/Colors.xaml"/>
        <ResourceDictionary Source="/LOLThemes.Wpf;component/Themes/Fonts.xaml"/>
    </ResourceDictionary.MergedDictionaries>
    
    <!-- TextDocumentValueConverter 资源 -->
    <smtxAe:TextDocumentValueConverter x:Key="TextDocumentValueConverter" />
    
    <!-- XamlDisplay 可折叠样式 - 参考 MaterialDesign 风格 -->
    <Style TargetType="{x:Type smtx:XamlDisplay}">
        <Setter Property="IsTabStop" Value="False"/>
        <Setter Property="Margin" Value="0,0,0,20"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type smtx:XamlDisplay}">
                    <StackPanel>
                        <!-- 控件显示区域 -->
                        <ContentPresenter ContentSource="Content"
                                        Margin="0,0,0,10"/>
                        
                        <!-- 代码显示区域 - 可折叠 -->
                        <Expander x:Name="CodeExpander"
                                IsExpanded="False"
                                Style="{StaticResource LOLExpanderStyle}">
                            <Expander.Header>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="&lt;/&gt;"
                                              FontSize="16"
                                              Foreground="{DynamicResource PrimaryGoldBrush}"
                                              Margin="0,0,8,0"
                                              VerticalAlignment="Center"/>
                                    <TextBlock Text="查看代码"
                                              FontSize="{StaticResource FontSizeNormal}"
                                              Foreground="{DynamicResource TextPrimaryBrush}"
                                              VerticalAlignment="Center"/>
                                </StackPanel>
                            </Expander.Header>
                            
                            <!-- 代码内容区域 -->
                            <Border Margin="0,10,0,0"
                                   Background="{DynamicResource BackgroundMediumBrush}"
                                   BorderBrush="{DynamicResource BorderDarkBrush}"
                                   BorderThickness="0.5"
                                   Padding="0"
                                   SnapsToDevicePixels="True">
                                <Border.Effect>
                                    <DropShadowEffect Color="{DynamicResource PrimaryGold}" 
                                                    BlurRadius="10" 
                                                    ShadowDepth="0" 
                                                    Opacity="0.2"/>
                                </Border.Effect>
                                
                                <DockPanel>
                                    <!-- 复制按钮 -->
                                    <Button DockPanel.Dock="Bottom"
                                          Margin="10,10,10,10"
                                          HorizontalAlignment="Right"
                                          Style="{StaticResource LOLSecondaryButtonStyle}"
                                          Command="Copy"
                                          CommandParameter="{Binding Xaml, RelativeSource={RelativeSource TemplatedParent}}"
                                          Content="复制代码"
                                          Padding="15,8"/>
                                    
                                    <!-- XAML 代码编辑器 -->
                                    <avalonEdit:TextEditor Document="{Binding Xaml, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource TextDocumentValueConverter}}"
                                                          Background="#0E1015"
                                                          Foreground="#F5EBD8"
                                                          FontFamily="Consolas, 'Courier New', monospace"
                                                          FontSize="13"
                                                          ShowLineNumbers="True"
                                                          LineNumbersForeground="#A09B8C"
                                                          IsReadOnly="True"
                                                          HorizontalScrollBarVisibility="Auto"
                                                          VerticalScrollBarVisibility="Auto"
                                                          MaxHeight="400"
                                                          Padding="10"/>
                                </DockPanel>
                            </Border>
                        </Expander>
                    </StackPanel>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

</ResourceDictionary>
